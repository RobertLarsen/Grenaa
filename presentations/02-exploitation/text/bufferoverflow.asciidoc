Anden opgave
------------
[source,c]
------------------------------------------------
include::../assignments/integer_conversion.bug[]
------------------------------------------------

Anden opgave
------------

Integer conversion!

[source,c]
------------------------------------------------
int num_users; /* <- Signed integer */

if (num_users <= MAX_USERS_PER_CHUNK) /* <- Signed comparison */

/* Prototype for read. 'count' er unsigned! */
ssize_t read(int fd, void *buf, size_t count);

/* Her går det galt */
read(socket, users, num_users * sizeof(user_t)); 
------------------------------------------------

Anden opgave
------------

[frame="topbot",options="header"]
|==================================================================================
| Beregning         | 2 komplementær repræsentation | Signed værdi | Unsigned værdi
| '-1'              | '0xffffffff'                  | -1           | 4294967296
| '-1 * 40'         | '0xffffffd8'                  | -40          | 4294967256
|==================================================================================

[source,c]
------------------------------------------------
/* Vi sender -1 */
read(socket, &num_users, sizeof(num_users));
if (-1 <= 8) {
    read(socket, users, 4294967256);
}
------------------------------------------------

Anden opgave
------------

Lytter på 'localhost:10001'

Find processen på jeres Vagrant box med:

[source,bash]
------------------------------------------------
$ cd /vagrant/presentations/02-exploitation/assignments
$ ps aux | grep exploitation | grep 10001 | awk '{print $2}'
3461
------------------------------------------------

Attach gdb med:

[source,bash]
------------------------------------------------
$ sudo gdb ./integer_conversion 3461
------------------------------------------------

eller:

[source,bash]
------------------------------------------------
$ sudo gdb ./integer_conversion $(ps aux | grep exploitation | grep 10001 | awk '{print $2}')
------------------------------------------------

Anden opgave - VirtualBox bug
-----------------------------

Hvis I ikke kan forbinde til processen, så er det nok pga. en fejl i VirtualBox som indtræder, når man har suspenderet og startet sin VM. Fix det sålades:

[source,bash]
------------------------------------------------
$ sudo service docker restart
------------------------------------------------
